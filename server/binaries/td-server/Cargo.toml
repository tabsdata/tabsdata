#
# Copyright 2024 Tabs Data Inc.
#

[package]
description = "Tabsdata Server"
name = "td-server"
build = "build.rs"

authors = { workspace = true }
edition = { workspace = true }
homepage = { workspace = true }
license = { workspace = true }
publish = { workspace = true }
readme = { workspace = true }
repository = { workspace = true }
rust-version = { workspace = true }
version = { workspace = true }

[[bin]]
name = "tdserver"
path = "src/bin/tdserver.rs"

[[bin]]
name = "bootloader"
path = "src/bin/bootloader.rs"

[[bin]]
name = "importer"
path = "src/bin/importer.rs"

[[bin]]
name = "supervisor"
path = "src/bin/supervisor.rs"

[[bin]]
name = "transporter"
path = "src/bin/transporter.rs"

[[example]]
name = "tableframe"
path = "examples/tableframe/extension.rs"

[[example]]
name = "simple_server"
path = "examples/server/simple_server.rs"

[[example]]
name = "log_file"
path = "examples/telemetry/log_file.rs"

[[example]]
name = "log_stdout"
path = "examples/telemetry/log_stdout.rs"

[[example]]
name = "service"
path = "examples/tower/service.rs"

[[example]]
name = "hal"
path = "examples/dummy/hal.rs"

[[example]]
name = "tars"
path = "examples/dummy/tars.rs"

[lib]
name = "tabsdatalib"
path = "src/lib/lib.rs"

[features]
api-docs = []
enterprise = []
td-test = ["dummy", "mock-env", "test-utils"]
dummy = []
mock-env = []
sqlx_log = []
test_logging = []
test_tower_metadata = ["td-tower/test_tower_metadata"]
test-utils = []

[package.metadata.cargo-machete]
ignored = ["openssl", "paste", "strum", "toml", "utoipa-axum"]

# Build dependencies

[build-dependencies]

# Internal dependencies

td-build = { workspace = true }
td-python = { workspace = true }

# External dependencies

toml = { workspace = true }

[dependencies]

# Internal dependencies


## Macros

td-apiforge = { workspace = true }
td-build = { workspace = true }
tm-workspace = { workspace = true }

## Libraries

td-apiserver = { workspace = true }
td-common = { workspace = true }
td-database = { workspace = true }
td-error = { workspace = true }
te-tableframe = { workspace = true }
ta-tableframe = { workspace = true }
td-python = { workspace = true }
td-storage = { workspace = true }
td-tower = { workspace = true }

## Extensions

# External dependencies

async-trait = { workspace = true }
atomic_enum = { workspace = true }
axum = { workspace = true, features = ["macros"] }
base64 = { workspace = true }
bytes = { workspace = true }
chrono = { workspace = true }
clap = { workspace = true, features = ["derive"] }
clap_derive = { workspace = true }
colored = { workspace = true }
derive_builder = { workspace = true }
dirs = { workspace = true }
futures = { workspace = true }
futures-util = { workspace = true }
getset = { workspace = true }
http = { workspace = true }
indicatif = { workspace = true }
ignore = { workspace = true }
include_dir = { workspace = true }
indexmap = { workspace = true }
itertools = { workspace = true }
linemux = { workspace = true }
num-format = { workspace = true }
object_store = { workspace = true, features = ["aws", "azure", "gcp", "http"] }
paste = { workspace = true }
path-slash = { workspace = true }
polars = { workspace = true, features = ["lazy", "parquet", "csv", "json", "polars-lazy", "streaming", "cloud", "aws", "azure", "gcp", "cloud_write"] }
regex = { workspace = true }
reqwest = { workspace = true }
serde = { workspace = true, features = ["derive"] }
serde_json = { workspace = true }
serde_yaml = { workspace = true }
strum = { workspace = true }
strum_macros = { workspace = true }
supports-color = { workspace = true }
sysinfo = { workspace = true }
tabled = { workspace = true }
tempfile = { workspace = true }
testdir = { workspace = true }
textwrap = { workspace = true }
terminal_size = { workspace = true }
thiserror = { workspace = true }
tokio = { workspace = true, features = ["full"] }
tower = { workspace = true, features = ["buffer", "limit", "make", "timeout", "util"] }
tracing = { workspace = true }
url = { workspace = true, features = ["serde"] }
utoipa = { workspace = true, features = ["axum_extras", "preserve_order", "uuid"] }
utoipa-axum = { workspace = true }
walkdir = { workspace = true }
wildmatch = { workspace = true }

[dev-dependencies]
td-common = { workspace = true, features = ["td-test"] }
td-database = { workspace = true, features = ["td-test"] }
te-tableframe = { workspace = true, features = ["td-test"] }
ta-tableframe = { workspace = true, features = ["td-test"] }
td-server = { workspace = true, features = ["td-test"] }

[target.'cfg(target_os = "linux")'.dependencies]
openssl = { workspace = true, features = ["vendored"] }

[patch.crates-io]
zip = { git = "https://github.com/zip-rs/zip2", tag = "v2.6.1" }